---
import CompanyDropdown from "./CompanyDropdown.astro";
import FeaturesDropdown from "./FeaturesDropdown.astro";
import NavigationModal from "./NavigationModal.astro";
---

<nav
  class="sticky top-0 left-0 flex items-center justify-between container mx-auto px-4 sm:px-6 py-4 bg-dark/60 backdrop-blur-md z-50"
>
  <div>
    <a href="/" class="bg-white">
      <img class="w-40 h-auto" src="/assets/logo.svg" alt="Podcast--x" />
    </a>
  </div>

  <!-- mobile show nav menu button -->
  <div class="md:hidden">
    <button action-show-nav>
      <svg class="w-6 h-6 stroke-white hover:stroke-gray transition-all">
        <use href="/assets/icons.svg#icon-humbergur"></use>
      </svg>
    </button>
  </div>

  <NavigationModal />

  <ul class="hidden md:flex gap-6 lg:gap-10 text-sm font-medium">
    <li class="relative" id="navlink">
      <button
        class="flex items-center gap-1 py-3 transition-colors hover:text-light"
      >
        <span>Features</span>
        <svg class="w-5 h-5 fill-gray">
          <use href="/assets/icons.svg#icon-down"></use>
        </svg>
      </button>

      <FeaturesDropdown />
    </li>
    <li class="flex items-center gap-1 transition-colors hover:text-light">
      <a href="#">Pricing</a>
    </li>
    <li class="relative" id="navlink">
      <button
        class="flex items-center gap-1 py-3 transition-colors hover:text-light"
      >
        <span>Company</span>
        <svg class="w-5 h-5 fill-gray">
          <use href="/assets/icons.svg#icon-down"></use>
        </svg>
      </button>
      <CompanyDropdown />
    </li>
  </ul>

  <div class="space-x-4 font-medium text-md hidden md:block">
    <a href="#" class="text-gray hover:text-white">Sign in</a>
    <a
      href="#"
      class="px-3 py-2 border rounded-md broder-white hover:bg-white hover:text-dark"
      >Start free trial</a
    >
  </div>
</nav>

<script>
  const navigationLinks = document.querySelectorAll("#navlink");

  navigationLinks.forEach((navlink: Element) => {
    const dropdown = navlink.querySelector("#dropdown")!;
    navlink.addEventListener("click", (e) => {
      dropdown.classList.toggle("hidden");
    });
    document.addEventListener("click", (e) => {
      if (navlink.contains(e.target as Node)) return;
      dropdown.classList.add("hidden");
    });
  });

  // mobile navigation
  const showNavBtn: HTMLButtonElement =
    document.querySelector("[action-show-nav]")!;
  const hideNavBtn: HTMLButtonElement = document.querySelector(
    "[action-close-mobile-navbar]"
  )!;
  const mobileNav: HTMLElement = document.querySelector("[mobile-navbar]")!;

  showNavBtn.addEventListener("click", () => {
    mobileNav.classList.remove("hidden");
  });
  hideNavBtn.addEventListener("click", () => {
    mobileNav.classList.add("hidden");
  });
</script>
